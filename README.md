# EternalDraftSim_v0.1
An Eternal Card Game draft simulator implemented using JS, PHP, and MySQL.

The draft system implemented in Eternal is asynchronous, i.e. instead of passing packs around the table, as is the case in Magic the Gathering, the player receives a range of packs from the game’s database where they are stored after other players made picks from them. Because of this, the player is never constrained for time when making picks and this simulator is written to reflect this mechanic.

The booster generator (boostgen.php) function differs little from those used in previous projects and is a revamped version thereof pulling cards from a MySQL database (TET) to produce 12-card boosters of the game.

The draft mechanism (draft.php) is very different however because of peculiarities of asynchronous drafting in Eternal. It runs a set number of times making picks according to a mechanism (pick.php) similar to the one used for picks in DraftSim_v0.1A and producing a multidimensional array of numbers corresponding to card numbers that is then imploded into a single string and stored in a MySQL database (drafts). It doesn’t need to run again thereafter.

Once loaded the UI part of the program (index.php) queries the drafts database for the top draft string and its entry number storing them in variables. It then deletes the entry from its position at the top of the database and reattaches it at the bottom. The variables are then passed to the JS component of the UI which splits the string into a multidimensional array equivalent to the one originally produced by the draft mechanism.

The first booster is then displayed to the player allowing them to add a card of their choice to their main pool by clicking on the card’s image. The pick is shown on the right hand side of the screen in its reduced form that is determined by card data pulled from a JSON file (tetcards.json) and stored in a variable by the program during run time so as not to make continuous calls to the server to retrieve these data from the TET database.

Clicking on a card in the pool will put it into sideboard, which can be accessed by clicking on the Sideboard “button” above the pool column. Clicking on cards in the sideboard sends them back to main deck. To return to the main deck view the user can click the Maindeck “button”.

The graph above the UI buttons and the pool charts the cost curve of the cards in the deck informing the player’s pick decisions. This is implemented using Flotr2 library.

Once the draft is over (i.e. all 48 picks have been made) the program returns the remaining array of cards back to the server with the original DB entry number assigned to one of the now empty end arrays. 

The receiving side of the code (receiver.php) reads the entry number and deletes the empty elements of the sub-arrays appending full 12-card booster arrays to the front and imploding the multidimensional array back into a string. It then uses the entry number to find the original entry and overwrite it with the new input thus driving towards human-determined draft sequences that should ideally replace the ones generated by machine.

If the draft is not finished for any reason, the original entry remains intact at the end of the DB and will be accessed again after all other entries before it have been processed.

I’m particularly fond of the back end mechanisms of this application and I feel that it is a reasonable take on the original experience, sans the gameplay. The UI component leaves much to be desired yet but I believe that it is definitely a step up from the previous Magic draft simulators.
